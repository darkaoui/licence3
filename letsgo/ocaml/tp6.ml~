type 'a stack = 'a list ref;;

exception Empty_stack;;
  
let create (): 'a stack = ref [];;

let empty (s:'a stack) = !s=[];;

let pop (s: 'a stack) = match !s with
  | []   -> raise Empty_stack
  | h::t -> s:=t; h
;;

let peek (s: 'a stack) = match !s with
  | []   -> raise Empty_stack
  | h::t -> h
;;

let  push e (s: 'a stack)  = match !s with
  | []   -> raise Empty_stack
  |  _ -> s:= e::(!s); !s
;;
  


